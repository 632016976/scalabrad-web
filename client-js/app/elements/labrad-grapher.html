<link rel="import" href="app-link.html">
<dom-module id="labrad-grapher">
  <style>
    :host {
      display: block;
      overflow: hidden;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    tbody tr:nth-child(1n).iron-selected {
      background-color: #ccc;
    }
    .label-wide {
      width: 100%;
      text-align: right;
    }
    dir-item {
      white-space: nowrap;
    }
    #outer {
      position: absolute;
      width: 100%;
      height: 100%;
    }
    #container {
      display: flex;
      flex-direction: row;
      height: 100%;
    }
    #listing {
      flex-basis: 40%;
      flex-grow: 1;
      overflow-y: scroll;
    }
    #buttons {
      position: fixed;
      height: 40px;
      z-index: 1;
      background: white;
    }
    #list {
      position: relative;
      top: 40px;
    }
    #details {
      flex-basis: 60%;
      flex-grow: 1;
      overflow-y: scroll;
    }
    .monospace {
      font-family: courier;
      text-overflow: ellipsis;
    }
    tbody tr:nth-child(odd) {
      background-color: #EEEEEE;
    }
    tbody tr:nth-child(odd):hover {
      background-color: #F6F699;
    }
    tbody tr:nth-child(even):hover {
      background-color: #FFFFAA;
    }
    td.item {
      white-space: nowrap;
    }
    iron-icon {
      margin: 5px;
    }
    iron-icon.folder {
      color: #CFBA78;
    }
    iron-icon.dataset {
      color: #209131;
    }
  </style>
  <template>
    <div id="outer">
    <div id="container">
      <div id="listing">
        <div id="buttons">
          <paper-icon-button icon="stars" id="star" on-click="starClicked" title="show starred items"></paper-icon-button>
          <paper-icon-button icon="delete" id="trash" on-click="trashClicked" title="show trashed items"></paper-icon-button>
        </div>
        <div id="list">
          <table>
            <tbody is="selectable-table" selected="{{selectedId}}" attr-for-selected="selid">
              <template is="dom-repeat" items="{{listItems}}">
                <tr selid="{{item.id}}">
                  <td class="item">
                    <template is="dom-if" if="{{item.isParent}}">
                      <iron-icon icon="arrow-back" item-icon></iron-icon>
                    </template>
                    <template is="dom-if" if="{{item.isDir}}">
                      <iron-icon icon="folder" item-icon class="folder"></iron-icon>
                    </template>
                    <template is="dom-if" if="{{item.isDataset}}">
                      <iron-icon icon="editor:insert-chart" item-icon class="dataset"></iron-icon>
                    </template>
                    <a is="app-link" path="{{item.url}}" href="{{item.url}}">{{item.name}}</a>
                  </td>
                  <td class="label-wide">
                    <template is="dom-if" if="{{item.starred}}">
                      <paper-icon-button icon="stars"></paper-icon-button>
                    </template>
                    <template is="dom-if" if="{{item.trashed}}">
                      <paper-icon-button icon="delete"></paper-icon-button>
                    </template>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>
      <div id="details">
        <h1>{{selectedDataset}}</h1>
        <template is="dom-if" if="{{selectedDataset}}">
          <table>
            <tr><th colspan="3">Independents</th></tr>
            <template is="dom-repeat" items="{{selectedDatasetInfo.independents}}">
              <tr>
                <td>{{item.label}}</td>
                <td></td>
                <td>{{item.unit}}</td>
              </tr>
            </template>

            <tr><th colspan="3">Dependents</th></tr>
            <template is="dom-repeat" items="{{selectedDatasetInfo.dependents}}">
              <tr>
                <td>{{item.label}}</td>
                <td>{{item.legend}}</td>
                <td>{{item.unit}}</td>
              </tr>
            </template>
          </table>

          <table>
            <tr><th colspan="2">Parameters</th></tr>
            <template is="dom-repeat" items="{{selectedDatasetInfo.params}}">
              <tr>
                <td class="monospace">{{item.name}}</td>
                <td class="monospace">{{item.value}}</td>
              </tr>
            </template>
          </table>
        </template>
      </div>
    </div>
    </div>
  </template>
</dom-module>
